[
    {
        "title": "Godmode Sigma Rule - C88C6E14",
        "description": "PoC rule to detect malicious activity - following the principle: if you had only one shot, what would you look for?",
        "level": "high",
        "rule": [
            "SELECT * FROM logs WHERE (EventID = \"4688\" AND ((CommandLine LIKE \"% -NoP %\" ESCAPE '\\' OR CommandLine LIKE \"% -W Hidden %\" ESCAPE '\\' OR CommandLine LIKE \"% -decode %\" ESCAPE '\\' OR CommandLine LIKE \"% /decode %\" ESCAPE '\\' OR CommandLine LIKE \"% -e% JAB%\" ESCAPE '\\' OR CommandLine LIKE \"% -e% SUVYI%\" ESCAPE '\\' OR CommandLine LIKE \"% -e% SQBFAFgA%\" ESCAPE '\\' OR CommandLine LIKE \"% -e% aWV4I%\" ESCAPE '\\' OR CommandLine LIKE \"% -e% IAB%\" ESCAPE '\\' OR CommandLine LIKE \"% -e% PAA%\" ESCAPE '\\' OR CommandLine LIKE \"% -e% aQBlAHgA%\" ESCAPE '\\' OR CommandLine LIKE \"%vssadmin delete shadows%\" ESCAPE '\\' OR CommandLine LIKE \"%reg SAVE HKLM\\\\SAM%\" ESCAPE '\\' OR CommandLine LIKE \"% -ma %\" ESCAPE '\\' OR CommandLine LIKE \"%Microsoft\\\\Windows\\\\CurrentVersion\\\\Run%\" ESCAPE '\\' OR CommandLine LIKE \"%.downloadstring(%\" ESCAPE '\\' OR CommandLine LIKE \"%.downloadfile(%\" ESCAPE '\\' OR CommandLine LIKE \"% /ticket:%\" ESCAPE '\\' OR CommandLine LIKE \"% sekurlsa%\" ESCAPE '\\' OR CommandLine LIKE \"% p::d %\" ESCAPE '\\' OR CommandLine LIKE \"%;iex(%\" ESCAPE '\\' OR CommandLine LIKE \"%schtasks% /create %AppData%\" ESCAPE '\\' OR CommandLine LIKE \"% comsvcs.dll,MiniDump%\" ESCAPE '\\' OR CommandLine LIKE \"% comsvcs.dll,#24%\" ESCAPE '\\') OR ((ParentProcessName LIKE \"%\\\\WINWORD.EXE%\" ESCAPE '\\' OR ParentProcessName LIKE \"%\\\\EXCEL.EXE%\" ESCAPE '\\' OR ParentProcessName LIKE \"%\\\\POWERPNT.exe%\" ESCAPE '\\' OR ParentProcessName LIKE \"%\\\\MSPUB.exe%\" ESCAPE '\\' OR ParentProcessName LIKE \"%\\\\VISIO.exe%\" ESCAPE '\\' OR ParentProcessName LIKE \"%\\\\OUTLOOK.EXE%\" ESCAPE '\\') AND (NewProcessName LIKE \"%\\\\cmd.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\powershell.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\wscript.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\cscript.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\schtasks.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\scrcons.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\regsvr32.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\hh.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\wmic.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\mshta.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\msiexec.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\forfiles.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\AppData\\\\%\" ESCAPE '\\')) OR ((NewProcessName LIKE \"%\\\\apache%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\tomcat%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\w3wp.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\php-cgi.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\nginx.exe%\" ESCAPE '\\' OR NewProcessName LIKE \"%\\\\httpd.exe%\" ESCAPE '\\') AND (CommandLine LIKE \"%whoami%\" ESCAPE '\\' OR CommandLine LIKE \"%net user %\" ESCAPE '\\' OR CommandLine LIKE \"%ping -n %\" ESCAPE '\\' OR CommandLine LIKE \"%systeminfo%\" ESCAPE '\\' OR CommandLine LIKE \"%&cd&echo%\" ESCAPE '\\' OR CommandLine LIKE \"%cd /d %\" ESCAPE '\\')) OR (NewProcessName LIKE \"%\\\\whoami.exe%\" ESCAPE '\\' AND User LIKE \"NT AUTHORITY\\\\SYSTEM\" ESCAPE '\\')))",
            "SELECT * FROM logs WHERE (Channel = \"Microsoft-Windows-Sysmon/Operational\" AND ((EventID = \"11\" AND (TargetFilename LIKE \"%.dmp%\" ESCAPE '\\' OR TargetFilename LIKE \"%Desktop\\\\how%\" ESCAPE '\\' OR TargetFilename LIKE \"%Desktop\\\\decrypt%\" ESCAPE '\\')) OR (EventID IN (\"12\", \"13\") AND (TargetObject LIKE \"%UserInitMprLogonScript%\" ESCAPE '\\' OR TargetObject LIKE \"%\\\\CurrentVersion\\\\Image File Execution Options\\\\%\" ESCAPE '\\')) OR (EventID IN (\"12\", \"13\") AND (TargetObject LIKE \"%\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\%\" ESCAPE '\\' OR TargetObject LIKE \"%\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\%\" ESCAPE '\\') AND (Details LIKE \"%AppData%\" ESCAPE '\\' OR Details LIKE \"%\\\\Users\\\\Public\\\\%\" ESCAPE '\\' OR Details LIKE \"%\\\\Temp\\\\%\" ESCAPE '\\' OR Details LIKE \"%powershell%\" ESCAPE '\\' OR Details LIKE \"%wscript%\" ESCAPE '\\' OR Details LIKE \"%cscript%\" ESCAPE '\\'))))",
            "SELECT * FROM logs WHERE (Channel = \"System\" AND EventID = \"7045\" AND (ServiceName LIKE \"%WCESERVICE%\" ESCAPE '\\' OR ServiceName LIKE \"%WCE SERVICE%\" ESCAPE '\\' OR ServiceName LIKE \"%winexesvc%\" ESCAPE '\\' OR ServiceName LIKE \"%DumpSvc%\" ESCAPE '\\' OR ServiceName LIKE \"%pwdump%\" ESCAPE '\\' OR ServiceName LIKE \"%gsecdump%\" ESCAPE '\\' OR ServiceName LIKE \"%cachedump%\" ESCAPE '\\'))"
        ]
    }
]